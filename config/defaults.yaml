---
# API Endpoints
moonlight_api: "https://moonlight.ts.sigaint.au/api/v1/machines/check_in"
sigaint_api: "https://api.sigaint.au/api/v1"

# Fleet configuration
fleet_rpm_url: https://f000.backblazeb2.com/file/sigaint-public/fleet-osquery-1.50.1.x86_64.rpm

# VMagent Metrics
vmagent_version: "latest"
vmagent_remote_write_url: "https://metrics-ingest.sigaint.au/api/v1/write"
vmagent_environment: "production"

# Node exporter
node_exporter_version: "latest"

clamd_onaccess_include_dirs:
  - /var/tmp
  - /bin
  - /tmp
  - /home

clamd_onaccess_exclude_path:
  - "^/proc/"
  - "^/sys/"

# Blackbox exporter
blackbox_version: "latest"
blackbox_exporter_listen_port: 9115

blackbox_exporter_config_dir: /etc/blackbox
blackbox_exporter_data_dir: /var/lib/blackbox

# Vector
vector_config_dest: /etc/vector/vector.yaml
vector_ingest_url: http://syslog.v4.ts.sigaint.au:9428/insert/elasticsearch/
vector_enabled: true

# Falco
falco_config_dest: /etc/falco/falco.yaml
falco_sidekick: "https://falco.sigaint.au"
falco_additional_rules:
 - { url: 'https://raw.githubusercontent.com/falcosecurity/rules/main/rules/falco-incubating_rules.yaml', dest: '/etc/falco/falco-incubating_rules.yaml' }
 - { url: 'https://raw.githubusercontent.com/falcosecurity/rules/main/rules/falco-sandbox_rules.yaml',    dest: '/etc/falco/falco-sandbox_rules.yaml' }

# Tailscale
tailscale_authkey: "" # Set in secrets
tailscale_up_extra_flags: "--login-server=https://tailscale.sigaint.au --accept-dns=false --accept-routes=false"

# Supported distributions
sigaint_soe_supported_distributions:
  - FreeBSD
  - Fedora
  - RedHat

# DNS search domains
dns_search:
  - sigaint.au

# System settings
timezone: "Australia/Sydney"

# Syslog server has been replaced with Vector
# Only for Linux servers. *BSD will set this to true.
#
syslog_server: "syslog.v4.ts.sigaint.au:514"
syslog_server_enabled: false

# DNS servers for systemd-resolved (with DNS over TLS)
systemd_resolved_dns:
  - "76.76.2.22#xldfopbe6w.dns.controld.com"
  - "76.76.10.22#xldfopbe6w.dns.controld.com"
  - "2606:1a40::22#xldfopbe6w.dns.controld.com"
  - "2606:1a40:1::22#xldfopbe6w.dns.controld.com"

# DNS servers for resolv.conf (mostly FreeBSD)
resolv_conf_dns:
  - 76.76.2.109
  - 76.76.10.109
  - 2606:1a40:0:c:1efd:b67c:6598:0
  - 2606:1a40:1:c:1efd:b67c:6598:0

# NTP servers
ntp_servers:
  - time1.google.com
  - time2.google.com
  - time3.google.com
  - time4.google.com

# User SSH authorized keys (FreeBSD only)
user_ssh_keys:
  - name: "mhahl"
    url: https://github.com/mhahl.keys

# HBAC/Sudo configuration (FreeIPA-style)

# Host aliases (e.g., WORKSTATIONS)
hbac_sudo_hosts: []
# Example (uncomment to use):
# - name: WORKSTATIONS
#   hosts:
#     - ws0124.corp.sigaint.au

# Command aliases
hbac_sudo_commands: []
# Example (uncomment to use):
# - name: REBOOT
#   commands:
#     - /sbin/reboot
#     - /sbin/poweroff

# Sudo run-as rules
hbac_sudo_runas:
  # Administrators can run any command as root without password
  - name: "%grp-sigaint-admins"
    hosts:
      - ALL
    options:
      - NOPASSWD
    users:
      - root
    groups:
      - operator
    commands:
      - ALL

  # Users on workstations/laptops can run any command as root without password
  # (treated as personal machines)
  - name: "%grp-sigaint-users"
    hosts:
      - WORKSTATIONS
    options:
      - NOPASSWD
    users:
      - root
    groups:
      - operator
    commands:
      - ALL