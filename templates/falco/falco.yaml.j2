json_output: true
json_include_output_property: true
json_include_tags_property: true

log_stderr: true
log_syslog: true
log_level: info

# Explicitly enable stdout output (required in recent Falco versions to avoid "No output configured" error)
# This sends alerts to standard output (visible in journalctl and console)
stdout_output:
  enabled: true

# Load the container plugin (required for many default rules)
plugins:
  - name: container
    library_path: libcontainer.so
    init_config: ""
    open_params: ""

load_plugins:
  - container

# Rules files (default + custom directory)
rules_files:
  - /etc/falco/falco_rules.yaml
  - /etc/falco/falco_rules.local.yaml
  - /etc/falco/rules.d

watch_config_files: true

# Engine configuration (modern_eBPF is default)
engine:
  kind: modern_ebpf

  modern_ebpf:
    buf_size_preset: 6   # Increase if you see dropped events in logs/metrics

# Basic output throttling (optional â€“ adjust if needed)
priority: debug               # Minimum priority for alerts (change to warning/info in production)
output_timeout: 2000

# Prometheus metrics exposure
webserver:
  enabled: true
  listen_port: 8765
  prometheus_metrics_enabled: true

metrics:
  enabled: true
  interval: "30s"